        -:    0:Source:../src/CFSData.hpp
        -:    0:Graph:tc.gcno
        -:    0:Data:tc.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:#ifndef FSL_CFSDATA_H
        -:    2:#define FSL_CFSDATA_H
        -:    3:
        -:    4:#include <vector>
        -:    5:#include <exception>
        -:    6:#include <string>
        -:    7:#include <iostream>
        -:    8:
        -:    9:namespace FSL{
        -:   10:template <class FLOAT>
      151:   11:class CFST
        -:   12:{
        -:   13:    using seq=std::vector<FLOAT>;
        -:   14:    private:
        -:   15:        size_t n;
        -:   16:        FLOAT omega;
        -:   17:        seq A;
        -:   18:        seq B;
        -:   19:        //static const FLOAT zero=0;
        -:   20:    public:
        -:   21:
      204:   22:        const size_t& getn() const
        -:   23:        {
      204:   24:            return n;
        -:   25:        }
      112:   26:        void setn(const size_t& n_in)
        -:   27:        {
      112:   28:            n = n_in;
      112:   29:            A.resize(n+1);
      112:   30:            B.resize(n);
      112:   31:            std::fill(A.begin(), A.end(), 0.0);
      112:   32:            std::fill(B.begin(), B.end(), 0.0);
      112:   33:        }
        -:   34:
      143:   35:        const FLOAT& getomega() const
        -:   36:        {
      143:   37:            return omega;
        -:   38:        }
      114:   39:        void setomega(const FLOAT& omega_in)
        -:   40:        {
      114:   41:            if(omega_in<=0)
        -:   42:            {
        2:   43:                throw(std::invalid_argument("setomega: omega<=0"));
        -:   44:            }
      112:   45:            omega = omega_in;
      112:   46:        }
        -:   47:
       10:   48:        const seq& getA() const
        -:   49:        {
       10:   50:            return A;
        -:   51:        }
       56:   52:        void setA(const seq& A_in)
        -:   53:        {
       56:   54:            if (A_in.size()!=(n+1))
        -:   55:            {
        2:   56:                throw(std::invalid_argument("setA: mismatch A.size() and n+1"));
        -:   57:            }
       54:   58:            A = A_in;
       54:   59:        }
        -:   60:
       11:   61:        const seq& getB() const
        -:   62:        {
       11:   63:            return B;
        -:   64:        }
       56:   65:        void setB(const seq& B_in)
        -:   66:        {
       56:   67:            if (B_in.size()!=(n))
        -:   68:            {
        2:   69:                throw(std::invalid_argument("setB: mismatch B.size() and n"));
        -:   70:            }
       54:   71:            B = B_in;
       54:   72:        }
        -:   73:
     1729:   74:        FLOAT getAi(size_t i) const
        -:   75:        {
        -:   76:            if(i<0)
        -:   77:            {
        -:   78:                throw std::out_of_range("getAi: i<0, i=" + std::to_string(i));
        -:   79:            }
     1729:   80:            if(i>n)
        -:   81:            {
        1:   82:                throw std::out_of_range("getAi: i>n, i=" + std::to_string(i) + ",n="+std::to_string(n));
        -:   83:            }
     1728:   84:            return A[i];
        -:   85:        }
      150:   86:        void setAi(size_t i, const FLOAT& Ai_in)
        -:   87:        {
        -:   88:            if(i<0)
        -:   89:            {
        -:   90:                throw std::out_of_range("setAi: i<0, i=" + std::to_string(i));
        -:   91:            }
      150:   92:            if(i>n)
        -:   93:            {
    #####:   94:                throw std::out_of_range("setAi: i>n, i=" + std::to_string(i) + ",n="+std::to_string(n));
        -:   95:            }
      150:   96:            A[i] = Ai_in;
      150:   97:        }
     1713:   98:        FLOAT getBi(size_t i) const
        -:   99:        {
        -:  100:            if(i<0)
        -:  101:            {
        -:  102:                throw std::out_of_range("getBi: i<0, i=" + std::to_string(i));
        -:  103:            }
     1713:  104:            if(i>n)
        -:  105:            {
        1:  106:                throw std::out_of_range("getBi: i>n, i=" + std::to_string(i) + ",n="+std::to_string(n));
        -:  107:            }
     1712:  108:            if (i==0)
      604:  109:                return FLOAT(0);
     1108:  110:            return B[i-1];
        -:  111:        }
      140:  112:        void setBi(size_t i, const FLOAT& Bi_in)
        -:  113:        {            
        -:  114:            if(i<0)
        -:  115:            {
        -:  116:                throw std::out_of_range("setBi: i<0, i=" + std::to_string(i));
        -:  117:            }
      140:  118:            if(i>n)
        -:  119:            {
    #####:  120:                throw std::out_of_range("setBi: i>n, i=" + std::to_string(i) + ",n="+std::to_string(n));
        -:  121:            }
      140:  122:            if (i!=0)
       97:  123:                B[i-1]=Bi_in;
      140:  124:        }
       59:  125:        CFST(size_t n_in, FLOAT omega_in)
       59:  126:        {
       59:  127:            setn(n_in);
       59:  128:            setomega(omega_in);
       59:  129:        }
       51:  130:        CFST(size_t n_in, FLOAT omega_in, const std::vector<FLOAT>& A_in, const std::vector<FLOAT>& B_in)
       51:  131:        {
       51:  132:            setn(n_in);
       51:  133:            setomega(omega_in);
       51:  134:            setA(A_in);
       51:  135:            setB(B_in);
       51:  136:        }
        -:  137:};
        -:  138:
        -:  139:template <class FLOAT>
        -:  140:std::ostream& operator<<(std::ostream& os, const CFST<FLOAT>& f)
        -:  141:{
        -:  142:    os<<f.getn()<<", ";
        -:  143:    os<<f.getomega()<<", ";
        -:  144:    size_t n = f.getn();
        -:  145:    os<<"{";
        -:  146:    for (size_t i = 0; i<n; ++i)
        -:  147:    {
        -:  148:        os<<f.getAi(i)<<", ";
        -:  149:    }
        -:  150:    os<<f.getAi(n)<<"}, {";
        -:  151:    for (size_t i = 1; i<n; ++i)
        -:  152:    {
        -:  153:        os<<f.getBi(i)<<", ";
        -:  154:    }
        -:  155:    os<<f.getBi(n)<<"}";
        -:  156:    return os;
        -:  157:}
        -:  158:}
        -:  159:#endif
